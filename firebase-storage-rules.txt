// Règles Firebase Storage pour AfroConnect
// À copier dans la console Firebase Storage Rules

rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Images des Afroshops - permissions plus ouvertes pour le développement
    match /afroshops/{imageId} {
      allow read: if true; // Tout le monde peut lire les images
      allow write: if request.auth != null // Utilisateurs authentifiés
                   && request.resource != null // Fichier existe
                   && request.resource.size < 5 * 1024 * 1024 // Max 5MB
                   && request.resource.contentType != null // Type défini
                   && request.resource.contentType.matches('image/.*'); // Images seulement
    }
    
    // Règles temporaires pour debug (plus permissives)
    match /afroshops/{allFiles=**} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    // Par défaut, refuser tout autre accès
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}