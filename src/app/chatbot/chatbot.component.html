<!-- Bouton flottant pour ouvrir le bot partout -->
<button *ngIf="!showChat && !isMobile" class="chatbot-float-btn" (click)="toggleChatHandler()">ðŸ’¬ Diamal</button>
<!-- Sur mobile on affiche le bouton diffÃ©remment (dans la page Hilfe) -->
<button *ngIf="!showChat && isMobile" class="chatbot-float-btn mobile-btn" (click)="toggleChatHandler()">ðŸ’¬ Diamal</button>

<!-- Bulle du bot, mobile et desktop -->
<div *ngIf="showChat" class="chatbot-bubble" [ngClass]="{ 'mobile': isMobile }">
  <div class="chatbot-header">
    <span>ðŸ¤– Diamal <span class="ai-badge" *ngIf="isAIMode">âš¡ IA</span></span>
    <div class="header-buttons">
      <button class="ai-toggle-btn" (click)="toggleAIMode()" [title]="isAIMode ? 'DÃ©sactiver IA' : 'Activer IA'">
        {{ isAIMode ? 'ðŸ¤–' : 'ðŸ“‹' }}
      </button>
      <button class="reset-btn" (click)="resetConversation()" title="RÃ©initialiser">ðŸ”„</button>
      <button class="close-btn" (click)="toggleChatHandler()">Ã—</button>
    </div>
  </div>
  
  <div class="chatbot-messages">
    <div *ngFor="let msg of messages" [class.user]="msg.from === 'user'" [class.bot]="msg.from === 'bot'" [class.loading]="msg.isLoading">
      <span *ngIf="!msg.isHtml && !msg.isLoading">{{ msg.text }}</span>
      <span *ngIf="msg.isHtml && !msg.isLoading" [innerHTML]="msg.text"></span>
      <span *ngIf="msg.isLoading" class="typing-indicator">
        <span></span><span></span><span></span>
      </span>
    </div>
    <div #messagesEnd></div>
  </div>
  
  <!-- Champ de saisie pour mode IA -->
  <div class="chatbot-input" *ngIf="isAIMode">
    <input 
      type="text" 
      [(ngModel)]="userInput" 
      (keyup.enter)="sendUserMessage()"
      placeholder="Posez votre question..."
      [disabled]="isTyping"
      class="message-input"
    />
    <button 
      (click)="sendUserMessage()" 
      [disabled]="!userInput.trim() || isTyping"
      class="send-btn"
    >
      ðŸ“¤
    </button>
  </div>
  
  <!-- Boutons prÃ©dÃ©finis (toujours visibles) -->
  <div class="chatbot-topics">
    <button *ngFor="let topic of topics" (click)="selectTopic(topic)">{{ topic }}</button>
  </div>
</div>
