<div class="dashboard-container">

  <h2><span style="font-size:1.5em;">ğŸ“Š</span> Bestellungen fÃ¼r Ihren Shop</h2>
  <button class="modern-btn dashboard-return" style="margin-bottom:1.5rem;" (click)="goToShop()" [disabled]="!shopIdReady">â† ZurÃ¼ck zum Shop</button>
  <div *ngIf="orders.length === 0" class="dashboard-empty">
    <p>Keine Bestellungen gefunden.</p>
  </div>
  <div class="dashboard-info" *ngIf="orders.length > 0">
    <p style="color: #1e88e5; font-size: 0.9rem; margin-bottom: 0.5rem;">
      ğŸ’¡ <em>Tipp: Wischen Sie nach links/rechts und oben/unten, um alle Informationen zu sehen.</em>
    </p>
  </div>
  <div class="dashboard-table-wrapper" *ngIf="orders.length > 0">
    <ng-container *ngFor="let group of groupedOrders">
      <div class="date-separator">
        <h3>{{ group.label }}</h3>
        <span class="order-count">{{ group.orders.length }} Bestellung(en)</span>
      </div>
      
      <table class="dashboard-table">
        <thead>
          <tr>
            <th>Uhrzeit</th>
            <th>Kunde</th>
            <th>Produkte</th>
            <th>Menge</th>
            <th>Gesamtbetrag (â‚¬)</th>
            <th>Zahlungsart</th>
            <th>Lieferart</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let order of group.orders">
            <td><strong>{{ order.createdAt?.toDate() | date:'HH:mm' }}</strong></td>
            <td>
              <ng-container *ngIf="order.clientInfo; else noClientInfo">
                <strong>{{ order.clientInfo.firstName }} {{ order.clientInfo.lastName }}</strong><br>
                {{ order.clientInfo.street }} {{ order.clientInfo.number }}<br>
                {{ order.clientInfo.plz }} {{ order.clientInfo.city }}<br>
                Tel: {{ order.clientInfo.phone }}<br>
                <span *ngIf="order.clientInfo.email">E-Mail: {{ order.clientInfo.email }}</span>
              </ng-container>
              <ng-template #noClientInfo>
                <span style="color:#888">Aucune info client</span>
              </ng-template>
            </td>
            <td>
              <ul>
                <li *ngFor="let product of order.products">{{ product.name }}</li>
              </ul>
            </td>
            <td>
              <ul>
                <li *ngFor="let product of order.products">{{ product.quantity }}</li>
              </ul>
            </td>
            <td>â‚¬{{ order.total.toFixed(2) }}</td>
            <td>{{ order.paymentMethod }}</td>
            <td>
              <span *ngIf="order.deliveryType === 'abholung'" style="color: #1a8917;">ğŸª Abholung</span>
              <span *ngIf="order.deliveryType === 'lieferung'" style="color: #ff6b35;">ğŸšš Lieferung</span>
              <span *ngIf="!order.deliveryType" style="color: #888;">-</span>
            </td>
          </tr>
        </tbody>
      </table>
    </ng-container>
  </div>
</div>
