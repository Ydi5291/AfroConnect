<div class="dashboard-container">

  <h2><span style="font-size:1.5em;">üìä</span> {{ texts.title }}</h2>
  <button class="modern-btn dashboard-return" style="margin-bottom:1.5rem;" (click)="goToShop()" [disabled]="!shopIdReady">‚Üê {{ texts.backToShop }}</button>
  <div *ngIf="orders.length === 0" class="dashboard-empty">
    <p>{{ texts.noOrders }}</p>
  </div>
  <div class="dashboard-info" *ngIf="orders.length > 0">
    <p style="color: #1e88e5; font-size: 0.9rem; margin-bottom: 0.5rem;">
      üí° <em>{{ texts.tip }}</em>
    </p>
  </div>
  <div class="dashboard-table-wrapper" *ngIf="orders.length > 0">
    <ng-container *ngFor="let group of groupedOrders">
      <div class="date-separator">
        <h3>
          {{ group.label }}
          <span class="order-count">{{ group.orders.length }} {{ texts.orders }}</span>
        </h3>
      </div>
      
      <table class="dashboard-table">
        <thead>
          <tr>
            <th>{{ texts.time }}</th>
            <th>{{ texts.customer }}</th>
            <th>{{ texts.products }}</th>
            <th>{{ texts.quantity }}</th>
            <th>{{ texts.totalAmount }}</th>
            <th>{{ texts.paymentMethod }}</th>
            <th>{{ texts.deliveryType }}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let order of group.orders">
            <td><strong>{{ order.createdAt?.toDate() | date:'HH:mm' }}</strong></td>
            <td>
              <ng-container *ngIf="order.clientInfo; else noClientInfo">
                <strong>{{ order.clientInfo.firstName }} {{ order.clientInfo.lastName }}</strong><br>
                {{ order.clientInfo.street }} {{ order.clientInfo.number }}<br>
                {{ order.clientInfo.plz }} {{ order.clientInfo.city }}<br>
                Tel: {{ order.clientInfo.phone }}<br>
                <span *ngIf="order.clientInfo.email">E-Mail: {{ order.clientInfo.email }}</span>
              </ng-container>
              <ng-template #noClientInfo>
                <span style="color:#888">{{ texts.noClientInfo }}</span>
              </ng-template>
            </td>
            <td>
              <ul>
                <li *ngFor="let product of order.products">{{ product.name }}</li>
              </ul>
            </td>
            <td>
              <ul>
                <li *ngFor="let product of order.products">{{ product.quantity }}</li>
              </ul>
            </td>
            <td>‚Ç¨{{ order.total.toFixed(2) }}</td>
            <td>{{ order.paymentMethod }}</td>
            <td>
              <span *ngIf="order.deliveryType === 'abholung'" style="color: #1a8917;">üè™ {{ texts.pickup }}</span>
              <span *ngIf="order.deliveryType === 'lieferung'" style="color: #ff6b35;">üöö {{ texts.delivery }}</span>
              <span *ngIf="!order.deliveryType" style="color: #888;">-</span>
            </td>
          </tr>
        </tbody>
      </table>
    </ng-container>
  </div>
</div>
