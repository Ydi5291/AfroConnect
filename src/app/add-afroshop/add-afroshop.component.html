<div class="add-afroshop-container">
  <div class="form-header">
    <h2>{{ isEditMode ? '✏️ Afroshop bearbeiten' : '🏪 Neuen Afroshop hinzufügen' }}</h2>
    <p>{{ isEditMode ? 'Aktualisieren Sie die Informationen' : 'Teilen Sie Ihren Lieblings-Afroshop mit der Community!' }}</p>
  </div>

  <form (ngSubmit)="onSubmit()" class="afroshop-form">
    
    <!-- Import automatique depuis URL -->
    <div class="auto-import-section">
      <h3>🔗 Schnell hinzufügen</h3>
      <p>Fügen Sie einen Link ein, um Informationen automatisch zu laden</p>
      
      <div class="form-group">
        <label for="importUrl">Google Maps, Facebook, Nextdoor oder Website URL</label>
        <div class="url-input-group">
          <input 
            type="url" 
            id="importUrl"
            [(ngModel)]="importUrl"
            name="importUrl"
            placeholder="https://www.facebook.com/business... oder https://www.google.com/maps/place/..."
            class="form-input url-input">
          <button 
            type="button"
            (click)="importFromUrl()"
            [disabled]="!importUrl || isImporting"
            class="import-btn">
            <span *ngIf="!isImporting">📥 Importieren</span>
            <span *ngIf="isImporting">⏳ Lädt...</span>
          </button>
        </div>
      </div>
      
      <div class="divider">
        <span>oder manuell eingeben</span>
      </div>
    </div>
    
    <!-- Messages -->
    <div class="message success" *ngIf="successMessage">
      ✅ {{ successMessage }}
    </div>
    <div class="message error" *ngIf="errorMessage">
      ❌ {{ errorMessage }}
    </div>

    <!-- Geschäftsname -->
    <div class="form-group">
      <label for="name">Name des Geschäfts *</label>
      <input 
        type="text" 
        id="name"
        [(ngModel)]="afroshop.name"
        name="name"
        placeholder="z.B. Mama Afrika Restaurant"
        required
        class="form-input">
    </div>

    <!-- Type -->
    <div class="form-group">
      <label for="type">Typ *</label>
      <select 
        id="type"
        [(ngModel)]="afroshop.type"
        name="type"
        required
        class="form-select">
        <option value="restaurant">🍽️ Restaurant</option>
        <option value="epicerie">🛒 Lebensmittelgeschäft</option>
        <option value="coiffeur">✂️ Friseur</option>
        <option value="vetement">👗 Mode</option>
        <option value="services">🏦 Dienstleistungen</option>
      </select>
    </div>

    <!-- Upload d'image -->
    <div class="form-group">
      <label for="image">📸 Bild hochladen</label>
      <div class="image-upload-section">
        <input 
          type="file" 
          id="image"
          (change)="onFileSelected($event)"
          accept="image/*"
          class="file-input"
          #fileInput>
        
        <button 
          type="button" 
          (click)="fileInput.click()" 
          class="upload-btn"
          [disabled]="isUploadingImage">
          <span *ngIf="!imagePreview && !isUploadingImage">📁 Bild auswählen</span>
          <span *ngIf="imagePreview && !isUploadingImage">🔄 Anderes Bild wählen</span>
          <span *ngIf="isUploadingImage">⏳ Wird bearbeitet...</span>
        </button>
        
        <!-- Indicateur de progression -->
        <div *ngIf="isUploadingImage" class="upload-progress">
          <div class="progress-bar">
            <div class="progress-fill"></div>
          </div>
          <small>Bild wird komprimiert und vorbereitet...</small>
        </div>
        
        <!-- Bildvorschau -->
        <div *ngIf="imagePreview" class="image-preview-container">
          <img [src]="imagePreview" alt="Preview" class="image-preview">
          <button 
            type="button" 
            (click)="imagePreview = null; selectedFile = null; fileInput.value = ''" 
            class="remove-image-btn"
            title="Bild entfernen">
            ✕
          </button>
        </div>
        
        <small class="form-hint">Max. 5MB - Wird automatisch komprimiert und optimiert</small>
      </div>
    </div>

    <!-- Adresse -->
    <div class="form-group">
      <label for="address">Adresse *</label>
      <input 
        type="text" 
        id="address"
        [(ngModel)]="afroshop.address"
        name="address"
        placeholder="z.B. Müllerstraße 123, 13349 Berlin"
        required
        class="form-input">
      <small>Bitte geben Sie die vollständige Adresse mit Stadt an</small>
    </div>

    <!-- Telefon -->
    <div class="form-group">
      <label for="phone">Telefon *</label>
      <input 
        type="tel" 
        id="phone"
        [(ngModel)]="afroshop.phone"
        name="phone"
        placeholder="+49 30 12345678"
        required
        class="form-input">
    </div>

    <!-- Beschreibung -->
    <div class="form-group">
      <label for="description">Beschreibung *</label>
      <textarea 
        id="description"
        [(ngModel)]="afroshop.description"
        name="description"
        placeholder="Beschreiben Sie das Geschäft, Spezialitäten, Atmosphäre..."
        required
        rows="4"
        class="form-textarea"></textarea>
    </div>

    <!-- Cuisine (nur für Restaurants) -->
    <div class="form-group" *ngIf="afroshop.type === 'restaurant'">
      <label for="cuisine">Küche</label>
      <input 
        type="text" 
        id="cuisine"
        [(ngModel)]="afroshop.cuisine"
        name="cuisine"
        placeholder="z.B. Westafrikanische, Äthiopische, Nigerianische, Senegalesische"
        class="form-input">
      <small class="form-hint">Spezifizieren Sie die Art der afrikanischen Küche</small>
    </div>

    <!-- Öffnungszeiten -->
    <div class="form-group">
      <label for="hours">Öffnungszeiten</label>
      <input 
        type="text" 
        id="hours"
        [(ngModel)]="afroshop.hours"
        name="hours"
        placeholder="z.B. Mo-Fr: 09:00-18:00, Sa: 10:00-16:00, So: geschlossen"
        class="form-input">
      <small class="form-hint">Geben Sie die vollständigen Öffnungszeiten an</small>
    </div>

    <!-- Website -->
    <div class="form-group">
      <label for="website">Website</label>
      <input 
        type="url" 
        id="website"
        [(ngModel)]="afroshop.website"
        name="website"
        placeholder="https://www.beispiel.com"
        class="form-input">
      <small class="form-hint">Optional: Offizielle Website oder Social Media Profil</small>
    </div>

    <!-- Preisstufe -->
    <div class="form-group">
      <label for="priceLevel">Preisstufe</label>
      <select 
        id="priceLevel"
        [(ngModel)]="afroshop.priceLevel"
        name="priceLevel"
        class="form-select">
        <option value="">-- Bitte wählen --</option>
        <option value="1">€ - Günstig (unter 10€)</option>
        <option value="2">€€ - Moderat (10-20€)</option>
        <option value="3">€€€ - Gehoben (20-40€)</option>
        <option value="4">€€€€ - Hochpreisig (über 40€)</option>
      </select>
    </div>

    <!-- Buttons -->
    <div class="form-actions">
      <button 
        type="button" 
        (click)="goBack()"
        class="btn-secondary"
        [disabled]="isSubmitting || isUploadingImage">
        Abbrechen
      </button>
      <button 
        type="submit" 
        [disabled]="isSubmitting || isUploadingImage"
        class="btn-primary">
        <span *ngIf="isSubmitting && !isUploadingImage">{{ isEditMode ? '⏳ Wird aktualisiert...' : '⏳ Wird hinzugefügt...' }}</span>
        <span *ngIf="isUploadingImage">📤 Bild wird hochgeladen...</span>
        <span *ngIf="!isSubmitting && !isUploadingImage">{{ isEditMode ? '✅ Speichern' : '✅ Afroshop hinzufügen' }}</span>
      </button>
    </div>
  </form>
</div>
