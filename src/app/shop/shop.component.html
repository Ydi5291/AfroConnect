<div class="shop-container" *ngIf="afroshop">
	<div class="shop-header-btns">
		<button class="modern-btn" (click)="router.navigate(['/gallery'])">{{ texts.toGallery }}</button>
		<button class="modern-btn" (click)="router.navigate(['/afroshop', afroshop.id])">{{ texts.toShopInfo }}</button>
		<!-- Bouton Appeler : icÃ´ne seule -->
		<button *ngIf="!isShopOwner() && afroshop.phone" class="modern-btn call-header-btn" (click)="openUrl('tel:' + afroshop.phone, '_self')">ğŸ“</button>
		<button *ngIf="canEdit()" class="modern-btn primary" (click)="goToAddProduct()">â• {{ texts.addProducts }}</button>
		<button *ngIf="canEdit() && afroshop" class="modern-btn dashboard" (click)="goToDashboard(afroshop.id)">ğŸ“Š {{ texts.dashboard }}</button>
		<button *ngIf="isShopOwner()" class="modern-btn danger" (click)="openDeleteModal()">ğŸ—‘ï¸ {{ texts.deleteShop }}</button>
	</div>

       <!-- ...modale Impressum supprimÃ©e, Ã  placer dans image-detail.component.html... -->

	<div *ngIf="!afroshop.products || afroshop.products.length === 0" class="info-message">
		<span style="color:#d32f2f;font-weight:600;">{{ texts.notice }}</span> {{ texts.noOnlineOrder }}
	</div>
	<div class="products-grid">
		<div class="product-card" *ngFor="let product of afroshop.products">
			<img [src]="product.image" [alt]="product.name" class="product-image" />
			<div class="product-row">
				<div class="product-name">{{ product.name }}</div>
				<div class="product-price">{{ product.price | currency:'EUR' }}</div>
				<button class="add-to-cart-btn" (click)="addToCart(product)">ğŸ›’</button>
			</div>
			<div class="admin-actions" *ngIf="canEdit()">
				<button class="edit-btn" (click)="editProduct(product)">âœï¸</button>
				<button class="delete-btn" (click)="deleteProduct(product)">ğŸ—‘ï¸</button>
			</div>
		</div>
	</div>
</div>

<!-- Panier flottant global, hors du header pour Ã©viter la superposition -->
<div class="cart-float-global">
	<button class="cart-float-btn" (click)="toggleCart()">
		ğŸ›’
		<span class="cart-count" *ngIf="getCartItemCount() > 0">{{ getCartItemCount() }}</span>
	</button>
</div>

<div class="cart-overlay" *ngIf="cartOpen">
	<div class="cart-float-panel modern-cart">
		<div class="cart-header">
			<span class="cart-title">ğŸ›ï¸ {{ texts.myCart }}</span>
			<span class="cart-badge">{{ getCartItemCount() }}</span>
		</div>
		<ul class="cart-list">
			<li *ngFor="let item of cartItems" class="cart-item">
				<img [src]="item.product.image" [alt]="item.product.name" class="cart-item-img" />
				<div class="cart-item-info">
					<span class="cart-item-name">{{ item.product.name }}</span>
					<span class="cart-item-price">{{ item.product.price | currency:'EUR' }}</span>
				</div>
				<div class="cart-qty-controls">
					<button (click)="decrementQuantity(item)">-</button>
					<span>{{ item.quantity }}</span>
					<button (click)="incrementQuantity(item)">+</button>
				</div>
				<span class="cart-item-total">{{ item.product.price * item.quantity | currency:'EUR' }}</span>
				<button class="cart-remove-btn" (click)="decrementQuantity(item)" title="Entfernen">âœ–ï¸</button>
			</li>
		</ul>
		<div class="cart-total-row">
			<span>{{ texts.total }}</span>
			<strong class="cart-total">{{ getCartTotal() | currency:'EUR' }}</strong>
		</div>
			<div class="cart-actions">
				<button class="cart-order-btn" (click)="goToPayment()" [disabled]="getCartItemCount() === 0">{{ texts.checkout }}</button>
				<button class="close-cart-btn" (click)="toggleCart()">{{ texts.close }}</button>
			</div>
	</div>
</div>

<!-- ğŸ—‘ï¸ Modal de confirmation de suppression -->
<div *ngIf="showDeleteModal" class="delete-modal-overlay" (click)="closeDeleteModal()">
	<div class="delete-modal" (click)="$event.stopPropagation()">
		<button class="modal-close" (click)="closeDeleteModal()">âœ•</button>
		
		<div class="modal-icon">âš ï¸</div>
		
		<h2 class="modal-title">{{ texts.deleteConfirmTitle }}</h2>
		
		<p class="modal-message">{{ texts.deleteConfirmMessage }}</p>
		
		<div class="modal-warning">
			<strong>GelÃ¶scht werden:</strong>
			<ul>
				<li>âœ… Shop-Profil</li>
				<li>âœ… {{ afroshop?.products?.length || 0 }} Produkt(e)</li>
				<li>âœ… Alle Produktbilder</li>
				<li>âœ… Shop-Profilbild</li>
			</ul>
		</div>
		
		<div class="modal-actions">
			<button 
				class="btn-delete" 
				(click)="confirmDeleteShop()"
				[disabled]="deleteCountdown > 0 || deleteInProgress">
				<span *ngIf="deleteCountdown > 0">â³ {{ deleteCountdown }}s</span>
				<span *ngIf="deleteCountdown <= 0 && !deleteInProgress">{{ texts.deleteConfirmButton }}</span>
				<span *ngIf="deleteInProgress">{{ texts.deleteWait }}</span>
			</button>
			<button class="btn-cancel" (click)="closeDeleteModal()" [disabled]="deleteInProgress">
				{{ texts.deleteCancel }}
			</button>
		</div>
	</div>
</div>
